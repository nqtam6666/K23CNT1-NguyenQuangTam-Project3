<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
    th:replace="~{nqtCustomer/layout :: layout(title='Tài khoản của tôi - ' + (nqtWebsiteName ?: 'Hotel NQT'), description='Quản lý thông tin cá nhân - ' + (nqtWebsiteName ?: 'Hotel NQT'))}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style th:inline="css">
        .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.3); }
        .gold-accent { 
            color: /*[[${nqtWebsiteColor ?: '#d97706'}]]*/ #d97706;
        }
        :root {
            --color-primary: /*[[${nqtWebsiteColor ?: '#d97706'}]]*/ #d97706;
        }
        .btn-primary {
            background: linear-gradient(to right, var(--color-primary), var(--color-primary)cc);
        }
    </style>
</head>
<body>
    <div th:fragment="content" class="pb-16" style="margin-top: 100px;">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h1 class="font-serif text-4xl font-bold text-gray-900 mb-4">Tài khoản <span class="gold-accent">của tôi</span></h1>
                <p class="text-gray-600">Quản lý thông tin cá nhân của bạn</p>
            </div>

            <div th:if="${nqtCustomerUser}" class="glass-card rounded-2xl p-8 md:p-12">
                <form th:action="@{/nqtTaiKhoan/cap-nhat}" method="post" class="space-y-6">
                    <div>
                        <label for="nqtHoVaTen" class="block text-sm font-medium text-gray-700 mb-2">Họ và tên <span class="text-red-500">*</span></label>
                        <input type="text" id="nqtHoVaTen" name="nqtHoVaTen" th:value="${nqtCustomerUser.nqtHoVaTen}" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500">
                    </div>

                    <div>
                        <label for="nqtEmail" class="block text-sm font-medium text-gray-700 mb-2">Email <span class="text-red-500">*</span></label>
                        <input type="email" id="nqtEmail" name="nqtEmail" th:value="${nqtCustomerUser.nqtEmail}" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500">
                    </div>

                    <div>
                        <label for="nqtSoDienThoai" class="block text-sm font-medium text-gray-700 mb-2">Số điện thoại</label>
                        <input type="tel" id="nqtSoDienThoai" name="nqtSoDienThoai" th:value="${nqtCustomerUser.nqtSoDienThoai}"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500">
                    </div>

                    <div>
                        <label for="nqtDiaChi" class="block text-sm font-medium text-gray-700 mb-2">Địa chỉ</label>
                        <input type="text" id="nqtDiaChi" name="nqtDiaChi" th:value="${nqtCustomerUser.nqtDiaChi}"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cấp bậc</label>
                        <div class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 flex items-center">
                            <span th:if="${nqtCustomerUser.nqtCapBac == 'KhachVip'}"
                                class="px-3 py-1 inline-flex text-sm leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                <i class="bi bi-star-fill mr-1"></i> Khách VIP
                            </span>
                            <span th:if="${nqtCustomerUser.nqtCapBac == null or nqtCustomerUser.nqtCapBac == 'KhachThuong'}"
                                class="px-3 py-1 inline-flex text-sm leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
                                Khách thường
                            </span>
                        </div>
                        <p class="mt-1 text-xs text-gray-500">Cấp bậc được quản lý bởi hệ thống, không thể thay đổi tại đây.</p>
                    </div>

                    <!-- 2FA Section -->
                    <div class="border-t border-gray-200 pt-6">
                        <h3 class="font-semibold text-gray-900 mb-4">Bảo mật tài khoản</h3>
                        <div class="bg-gray-50 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-gray-900">Xác thực 2 yếu tố (2FA)</p>
                                    <p class="text-sm text-gray-600 mt-1">
                                        <span th:if="${nqtCustomerUser.nqt2faEnabled != null and nqtCustomerUser.nqt2faEnabled}">
                                            Đã bật - Tài khoản của bạn được bảo vệ bằng 2FA
                                        </span>
                                        <span th:unless="${nqtCustomerUser.nqt2faEnabled != null and nqtCustomerUser.nqt2faEnabled}">
                                            Chưa bật - Bảo vệ tài khoản bằng mã xác thực từ ứng dụng
                                        </span>
                                    </p>
                                </div>
                                <a th:href="@{/nqtTaiKhoan/setup-2fa}"
                                    class="px-4 py-2 rounded-lg font-medium transition-colors"
                                    th:class="${nqtCustomerUser.nqt2faEnabled != null and nqtCustomerUser.nqt2faEnabled} ? 'bg-yellow-100 text-yellow-800 hover:bg-yellow-200' : 'bg-blue-600 text-white hover:bg-blue-700'"
                                    th:text="${nqtCustomerUser.nqt2faEnabled != null and nqtCustomerUser.nqt2faEnabled} ? 'Quản lý' : 'Bật 2FA'">
                                    Bật 2FA
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="border-t border-gray-200 pt-6">
                        <h3 class="font-semibold text-gray-900 mb-4">Đổi mật khẩu (để trống nếu không muốn đổi)</h3>
                        <div class="space-y-4">
                            <div>
                                <label for="nqtMatKhauCu" class="block text-sm font-medium text-gray-700 mb-2">Mật khẩu hiện tại</label>
                                <input type="password" id="nqtMatKhauCu" name="nqtMatKhauCu"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500">
                            </div>
                            <div>
                                <label for="nqtMatKhauMoi" class="block text-sm font-medium text-gray-700 mb-2">Mật khẩu mới</label>
                                <input type="password" id="nqtMatKhauMoi" name="nqtMatKhauMoi"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500">
                            </div>
                            <div>
                                <label for="nqtMatKhauMoiXacNhan" class="block text-sm font-medium text-gray-700 mb-2">Xác nhận mật khẩu mới</label>
                                <input type="password" id="nqtMatKhauMoiXacNhan" name="nqtMatKhauMoiXacNhan"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500">
                            </div>
                        </div>
                    </div>

                    <div th:if="${nqtError}" class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg">
                        <span th:text="${nqtError}">Error message</span>
                    </div>

                    <div th:if="${nqtSuccess}" class="bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg">
                        <span th:text="${nqtSuccess}">Success message</span>
                    </div>

                    <button type="submit"
                        class="w-full text-white py-4 rounded-lg font-semibold hover:shadow-lg transition-all hover:scale-105 btn-primary"
                        th:style="'background: linear-gradient(to right, ' + ${nqtWebsiteColor ?: '#d97706'} + ', ' + ${#strings.replace(nqtWebsiteColor ?: '#d97706', '#', '')} + 'cc);'"
                        style="background: linear-gradient(to right, #d97706, #d97706cc);">
                        Cập nhật thông tin
                    </button>
                </form>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const primaryColor = /*[[${nqtWebsiteColor ?: '#d97706'}]]*/ '#d97706';
            const primaryColorDark = primaryColor + 'cc';
            
            // Apply color to buttons
            const buttons = document.querySelectorAll('.btn-primary');
            buttons.forEach(function(btn) {
                btn.style.background = 'linear-gradient(to right, ' + primaryColor + ', ' + primaryColorDark + ')';
            });
        });
    </script>
</body>
</html>

